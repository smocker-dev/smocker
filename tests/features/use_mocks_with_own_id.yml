name: Use mocks to respond
version: "2"
testcases:
  - name: Use basic mock with id
    steps:
      - type: http
        method: POST
        url: http://localhost:8081/mocks?reset=true
        bodyFile: ../data/basic_mock_with_id.yml
        assertions:
          - result.statuscode ShouldEqual 200
          - result.bodyjson.message ShouldEqual "Mocks registered successfully"

      - type: http
        method: GET
        url: http://localhost:8080/test
        assertions:
          - result.statuscode ShouldEqual 200
          - result.bodyjson.message ShouldEqual test

      - type: http
        method: GET
        url: http://localhost:8081/mocks
        assertions:
          - result.bodyjson.__len__ ShouldEqual 1
          - result.bodyjson.bodyjson0.state.id ShouldEqual 1

      - type: http
        method: POST
        url: http://localhost:8081/mocks
        bodyFile: ../data/basic_mock_with_id.yml
        assertions:
          - result.statuscode ShouldEqual 409